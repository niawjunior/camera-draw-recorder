<div class="flex flex-col items-center space-y-4 p-4">
  <!-- Hidden video for camera feed -->
  <video #video autoplay muted class="hidden"></video>

  <!-- Video rendering canvas -->
  <canvas #videoCanvas class="absolute w-80 h-60"></canvas>

  <!-- Drawing canvas -->
  <canvas
    #drawingCanvas
    class="absolute w-80 h-60"
    (mousedown)="startDrawing($event)"
    (mousemove)="draw($event)"
    (mouseup)="stopDrawing($event)"
    (mouseleave)="stopDrawing($event)"
  ></canvas>

  <!-- Controls -->
  <div class="space-x-4 absolute bottom-[400px]">
    <div>
      <label for="colorPicker">Choose a color:</label>
      <input
        type="color"
        id="colorPicker"
        [(ngModel)]="selectedColor"
        (change)="updateDrawingColor($event)"
      />
    </div>

    <div class="absolute top-[100px] gap-2 w-full flex justify-center">
      <div class="space-x-4 flex">
        <label>Drawing Mode:</label>
        <button
          class="px-4 py-2 bg-blue-500 text-white rounded"
          (click)="selectedShape = 'free'"
        >
          Free Draw
        </button>
        <button
          class="px-4 py-2 bg-blue-500 text-white rounded"
          (click)="selectedShape = 'square'"
        >
          Square
        </button>
        <button
          class="px-4 py-2 bg-blue-500 text-white rounded"
          (click)="selectedShape = 'rectangle'"
        >
          Rectangle
        </button>
      </div>

      <div class="flex gap-2">
        <button
          class="px-4 py-2 bg-gray-500 text-white rounded"
          (click)="undo()"
        >
          Undo (Ctrl+Z)
        </button>
        <button
          class="px-4 py-2 bg-gray-500 text-white rounded"
          (click)="redo()"
        >
          Redo (Ctrl+Y)
        </button>
      </div>
    </div>
    @if (!isRecording) {
    <button
      (click)="startRecording()"
      class="px-4 py-2 bg-blue-500 text-white rounded"
    >
      Start Recording
    </button>
    } @if(isRecording) {
    <button
      (click)="pauseRecording()"
      class="px-4 py-2 bg-yellow-500 text-white rounded"
    >
      Pause Recording
    </button>
    } @if (!isRecording && isPaused) {
    <button
      (click)="resumeRecording()"
      class="px-4 py-2 bg-purple-500 text-white rounded"
    >
      Resume Recording
    </button>
    } @if (isRecording || isPaused) {
    <button
      (click)="stopRecording()"
      class="px-4 py-2 bg-red-500 text-white rounded"
    >
      Stop Recording
    </button>
    }
    <button
      (click)="saveRecording()"
      class="px-4 py-2 bg-green-500 text-white rounded"
    >
      Save Recording
    </button>

    <button class="px-4 py-2 bg-red-500 text-white rounded" (click)="clearDB()">
      Clear DB
    </button>
  </div>
  <video
    #previewVideo
    class="w-80 h-60 absolute top-[470px] border"
    controls
  ></video>
</div>
